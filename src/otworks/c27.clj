(ns otworks.c29
  (:require ;; [overtone.core :refer :all :rename {ctl c}]
            [overtone.live :refer :all :rename {ctl c}]
            [otworks.functions :refer [get-samples boot]]))

;; Init

;; (boot)


;; SynthDefs

(definst c13s
  [f 220 a 0.1 at 15 rl 40 g 1]
  (-> (sin-osc [f (+ f 1)])
      (limiter 0.8 0.001)
      (* (env-gen (asr :attack at :curve 1 :release rl) :gate g :action 2))
      (* a)))

(definst c13w
  [b 0 fs 1 ws 0.1 p 0 ol 1 lf 2000 hf 200 a 1 att 15 rl 40 g 1]
  (-> (warp1 2 b p fs ws -1 ol 0.0 4)
      (lpf lf)
      (hpf hf)
      (* (env-gen (asr :attack att :curve 1 :release rl) :gate g :action 2))
      (* a)))

(definst c13wr
  [b 0 fs 1 ws 0.1 p 0 ol 1 lf 2000 hf 200 a 1 att 15 rl 40 g 1]
  (-> (warp1 2 b p fs ws -1 ol 0.0 4)
      (lpf lf)
      (hpf hf)
      (free-verb 1 1 1)
      (* (env-gen (asr :attack att :curve 1 :release rl) :gate g :action 2))
      (* a)))

(definst c14pb
  [b 0 r 1 tr 4 lf 1000 hf 50 a 1 att 20 rl 40 g 1]
  (-> (play-buf 2 b r (impulse:kr tr) 0 1 2)
      (lpf lf)
      (hpf hf)
      (free-verb 1 1 1)
      (* (env-gen (asr :attack att :curve 1 :release rl) :gate g :action 2))
      (* a)))


;; Track 1

(get-samples "~/Producing/august25th-2017/prefixed/t1/" (mapv #(str "s" % "f") (range 1 5)))

(def s1 (c13w :b s1f :p 0.1 :db 2 :fs 0.08 :ws 10 :hf 50 :at 20))
(c s1 :ol 2)
(def s2 (c13w :b s2f :p 0.1 :db 0.8 :fs 0.2 :ws 9 :hf 80))
(def s3 (c13w :b s3f :p 0.5 :db 1 :fs 0.4 :ws 8 :lf 4000 :at 25))
(c s1 :ol 4)
(c s2 :ol 3)
(c s3 :ol 5)
(c s1 :fs 0.06)
(c s2 :fs 0.14)
(c s3 :fs 0.17)
(def s4 (c13wr :b s4f :p 0.0 :db 2 :fs 0.2 :ws 15 :lf 4000 :hf 100))
(def s5 (c13s :f 90 :a 0.4))
(c s2 :fs 0.18)
(c s1 :fs 0.09)
(c s3 :fs 0.19)
(def s6 (c13s :f 3000 :a 0.004 :rl 30))
(c s6 :g 0)
(c s1 :g 0)
(c s2 :fs 0.16)
(c s4 :g 0)
(c s2 :g 0)
(c s3 :ol 1)
(c s3 :g 0)
(c s5 :g 0)

;; Track 2

(get-samples "~/Producing/august25th-2017/prefixed/t2/" (mapv #(str "s" % "f") (range 1 9)))

(def p1 (c13wr :b s2f :fs 0.1 :p 0.8 :ws 4 :lf 2000 :db 1.2 :hf 50 :at 20 :rl 40))
(def p2 (c13wr :b s1f :fs 0.05 :p 0.8 :ws 5 :lf 800 :db 1.2 :hf 50 :at 20 :rl 40))
(def p3 (c14pb :b s5f :r 0.25))
(c p3 :tr 0.3 :a 1.2)
(c p3 :tr 0.028)
(c p3 :tr 4 :g 0)
(c p1 :p 0.4 :ws 7)
(c p2 :p 0.1 :ws 8)
(def p4 (c13wr :b s3f :fs 0.08 :p 0.1 :ws 10 :lf 3000 :db 1.5 :hf 50 :at 20 :rl 40))
(def p5 (c13wr :b s6f :fs 0.35 :p 0.1 :ws 10 :lf 6000 :db 1.5 :hf 50 :at 20 :rl 40))
(c p4 :fs 0.5 :a 1.2)
(c p4 :fs 0.8 :ws 12)
(c p4 :fs 1.7)
(c p4 :fs 0.6)
(c p4 :fs 0.45)
(c p4 :fs 0.5)
(c p1 :fs 0.09)
(c p2 :fs 0.09)
(c p5 :g 0)
(c p4 :g 0)
(c p1 :fs 0.06)
(c p2 :fs 0.06)
(c p2 :g 0)
(c p1 :g 0)

(stop)
